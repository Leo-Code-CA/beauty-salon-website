import FnScrollDirection from './scrollDirection.js';

export default function slideInObserver(elem, className, options = {root: null, threshold: 0}) {

    const observer = new IntersectionObserver(handleIntersect, options);
    
    function handleIntersect(entries) {
        entries.forEach(entry => {
            const scrollDirection = FnScrollDirection(window.scrollY);
            // console.log(`scroll direction is ${scrollDirection}`);
            // console.log(`bounding client rect top is ${entry.boundingClientRect.top} and scroll direction is ${scrollDirection}`)
            console.log(entry.boundingClientRect.top > 0 ? 'add class' : 'remove class')
            if (entry.isIntersecting && scrollDirection === "down") {
                // console.log(`entry is intersecting and scroll direction is down = I add the animation class`);
                entry.target.classList.add(className);
            } else if (entry.boundingClientRect.top > 0 && scrollDirection === "up") {
                // console.log(`entry bounding client rect top is > 0 and scroll direction is up = I remove the animation class`);
                entry.target.classList.remove(className);   
            };
        });
    };
    observer.observe(elem);
};

// INTERESTING CODE FROM MDN:
// function intersectionCallback(entries) {
//     entries.forEach((entry) => {
//       entry.target.style.opacity = entry.intersectionRatio;
//     });
// }